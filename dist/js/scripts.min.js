if (sessionStorage.getItem("pass") == null) {
    sessionStorage.setItem("pass","-1");
    
}

function getHtml(file) {
    let path = `dist/files/${file}`;
    if (file.indexOf('.jpg') > -1) {
        $('.modal-title').text('Image File');
        return `
        <a href="${path}" target="_blank" class="btn btn-sm btn-primary mb-3">Open Image</a>
        <a target="_blank" href="${path}"><img src="${path}" class="img-fluid" alt="image"/></a>
        `;
    }

    if (file.indexOf('.mp3') > -1) {
        $('.modal-title').text('Audio File');

        return `
        <audio controls style="width:80%;" autoplay>
          <source src="${path}" type="audio/mpeg">
          Your browser does not support the audio element.
        </audio>
        `;
    }

    if (file.indexOf('.mp4') > -1) {
        $('.modal-title').text('Video File');
        return `
            <video width="100%" controls autoplay>
                <source src="${path}" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        `;
    }

    $('.modal-title').text('Error');
    return `<p>An error has occured, please try again.</p>`;
};


$(document).ready(function () {
    const var1 = "YWxleF9iYWtlcg==";
    const var2 = "UGFkaWxsYUJheTIw";
    $('.login-card-body button').click(function (event) {
        event.preventDefault();
        $('.error').hide();
        var email = $('[type="text"]').val(),
            password = $('[type="password"]').val();
        if (email && password) {
            if (btoa(email.toLowerCase()) != var1 || btoa(password) != var2) {
                $('.error').show();
            }
            else {
                sessionStorage.setItem("pass","1");
                window.location.href = 'files.html';
            }
        }
        else {
            $('.error').show();
        }

    });

    // if (window.location.pathname !== 'SherlockDB.html' && document.cookie.indexOf('pass=1') === -1 && window.location.pathname.indexOf('/C') === -1) {
    //     window.location.href = 'SherlockDB.html';
    // }
    
    // if (window.location.pathname === 'files.html'  && sessionStorage.getItem("pass") !== "1") {
    //     window.location.href = 'SherlockDB.html';
    // }

    $(document).click(function (event) {
        if (event.target.type === 'submit') {
            return;
        }
        $('.error').hide();
    });

    $('[data-file]').on("click", function (event) {
        event.preventDefault();
        var file = $(this).data('file');
        var html = getHtml(file);
        $('.modal-body').html(html);
        $('.modal').modal();
    });

    $(".modal").on("hidden.bs.modal", function () {
        $('.modal-body').html('');
    });

});
